# **Решение:**

HandleEventsCommand

- **run** – при выполнении не возникает исключений.
    
- **shouldEventBeRan** – если передан EventDto, который совпадает по времени с текущим временем, должен вернуть true. Можем написать unit-тест, но придется сделать метод открытым.
    
- **shouldEventBeRan** – если передан EventDto, который не совпадает по времени с текущим временем, должен вернуть false. Можем написать unit-тест, но придется сделать метод открытым.
    
- **HandleEventsDaemonCommand** пропустим т.к. это демон и его мы не можем протестировать в phpunit

SaveEventCommand

- **run** – если переданы значения, то они сохраняются в БД.
    
- **run** – если значения не переданы, то возвращается текст справки. Этот сценарий не содержит побочных эффектов, поэтому его мы можем протестировать.
    
- **getGetoptOptionValues** – не тестируем, т.к. мы не можем передать getopt опции из phpunit
    
- **isNeedHelp** – если не переданы параметры name, text, receiver или cron или переданы параметры -h или --help возвращает true. Можем протестировать, но нужно сделать метод публичным.
    
- **isNeedHelp** – если переданы параметры name, text, receiver и cron и не переданы параметры -h или --help возвращает false. Можем протестировать, но нужно сделать метод публичным.
    
- **showHelp** – возвращает текст, в котором присутствует слово “СПРАВКА”. Можем протестировать, но нужно сделать метод публичным.
    
- **getCronValues** – все * преобразуются в null. Можем протестировать, но нужно сделать метод публичным.
    
- **getCronValues** – все значения кроме * преобразуются в строку. Можем протестировать, но нужно сделать метод публичным.
    
- **getCronValues** – размер возвращаемого массива равен количеству пробелов во входящей строке +1. Можем протестировать, но нужно сделать метод публичным.
    
- **saveEvent** – не тестируем т.к. при тестировании считается функциональным тестированием за счет обращения в БД.

TgMessagesCommand

- **run** –  не тестируем т.к. он имеет много побочных эффектов (обращение к телеграм + сохранение данных в БД).
    
- **createEventAndReturnMessage** – то же самое, что и run.
    
- **getCronValues** – тестируем аналогично getCronValues в SaveEventCommand.
    
- **saveEvent** – не тестируем т.к. при тестировании считается функциональным тестированием за счет обращения в БД.
    
EventSender

- **sendMessage** – не тестируем, потому что, по сути, вызываем обращение к телеграм, что переводит наш тест в функциональный.

TelegramApiImpl

- **getMessages** – отсутствуют ошибки при обработке данных из телеграм.  Не тестируем, потому что, по сути, вызываем обращение к телеграм, что переводит наш тест в функциональный.
    
- **getMessages** – возвращает массив формата
    
    [
    
    'offset' => $offset,
    
    'result' => $result,
    
    ]
    
    Не тестируем, потому что по сути вызываем обращение к телеграм, что переводит наш тест в функциональный. 
    
- **sendMessage** – не содержит ошибок при общении с Телеграм. Не тестируем, потому что, по сути, вызываем обращение к телеграм, что переводит наш тест в функциональный.

Контракты для Unit-тестирования:

1. **HandleEventsCommand::shouldEventBeRan –** если передан EventDto, который совпадает по времени с текущим временем должен вернуть true. Можем написать unit-тест, но придется сделать метод открытым.
2. **HandleEventsCommand::shouldEventBeRan –** если передан EventDto, который не совпадает по времени с текущим временем должен вернуть false. Можем написать unit-тест, но придется сделать метод открытым.
3. **SaveEventCommand::run –** если значения не переданы, то возвращается текст справки. Этот сценарий не содержит побочных эффектов, поэтому его мы можем протестировать.
4. **SaveEventCommand::isNeedHelp –** если не переданы параметры name, text, receiver или cron или переданы параметры -h или --help возвращает true. Можем протестировать, но нужно сделать метод публичным.
5. **SaveEventCommand::isNeedHelp –** если переданы параметры name, text, receiver и cron и не переданы параметры -h или --help возвращает false. Можем протестировать, но нужно сделать метод публичным.
6. **SaveEventCommand::showHelp –** возвращает текст, в котором присутствует слово “СПРАВКА”. Можем протестировать, но нужно сделать метод публичным.
7. **SaveEventCommand::getCronValues** – все * преобразуются в null. Можем протестировать, но нужно сделать метод публичным.
8. **SaveEventCommand::getCronValues** – все значения кроме * преобразуются в строку. Можем протестировать, но нужно сделать метод публичным.
9. **SaveEventCommand::getCronValues** – размер возвращаемого массива равен количеству пробелов во входящей строке +1. Можем протестировать, но нужно сделать метод публичным.
10. **TgMessagesCommand::getCronValues** – тестируем аналогично getCronValues в SaveEventCommand.